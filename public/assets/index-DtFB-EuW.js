import{u as y,r as l,j as s,m as h,B as a,E as x,A as f,M as w}from"./index-C-g3yOAE.js";import{baseColumns as k}from"./columns-BqT64dcv.js";import C from"./index-Du8qq867.js";import{P as j}from"./Table-OlwSqMJK.js";import"./dateUtil-BnlWTJph.js";import"./index-B3SaLqtB.js";import"./common-Ba1hFKtc.js";import"./index-BWOfSK86.js";import"./index-hJJE_L4a.js";import"./index-CmPvz_FA.js";import"./index-BsOYpZyI.js";const{confirm:g}=w,E=(e,o)=>{g({title:"确认删除吗？",icon:s.jsx(x,{}),content:"删除后不可恢复！",onOk(){f.systemMenu.menuDelete({id:e.id}).then(()=>o.current.reload())}})},R=async(e,o)=>{var r;try{await e.show(),e.remove(),(r=o.current)==null||r.reload()}catch{e.reject(new Error("something went wrong"))}},M=async(e,o,r)=>{var t;await e.show({data:o}),e.remove(),(t=r.current)==null||t.reload()},v=async(e,o,r)=>{var t;await e.show({data:o,type:"edit"}),e.remove(),(t=r.current)==null||t.reload()},L=()=>{const e=y(C),[o,r]=l.useState([]),t=l.useRef(),m=[...k,{title:"操作",valueType:"option",key:"option",align:"center",width:160,fixed:"right",render:(n,i)=>[s.jsx(a,{type:"link",onClick:()=>M(e,i,t),disabled:i.type===2,children:"新增"},"add"),s.jsx(a,{type:"link",onClick:()=>v(e,i,t),children:"编辑"},"edit"),s.jsx(a,{type:"link",onClick:()=>E(i,t),children:"删除"},"delete")]}],d=n=>{const i=[];return n.forEach(p=>{i.push(p.id);const c=p.children;c!=null&&c.length&&i.push(...d(c))}),i},u=l.useRef();return s.jsx(j,{onDataSourceChange:n=>{u.current=n},columns:m,actionRef:t,request:async n=>(n.name===""&&delete n.name,n.path===""&&delete n.path,n.component===""&&delete n.component,{data:await h(n),success:!0}),rowKey:"id",pagination:!1,expandable:{expandedRowKeys:o.length===0?void 0:o},columnEmptyText:!1,dateFormatter:"string",scroll:{x:2e3,y:800},toolBarRender:()=>[s.jsx(a,{onClick:()=>{r(d(u.current))},children:"展开全部"},"open"),s.jsx(a,{onClick:()=>{r([])},children:"折叠全部"},"close"),s.jsx(a,{type:"primary",onClick:()=>R(e,t),children:"新增"},"primary")]})};export{L as default};
