import{u as y,r as l,j as s,B as a,E as h}from"./index-BdVTcDul.js";import{m as x,A as f}from"./index-BIg947uO.js";import{baseColumns as w}from"./columns-C_feAL-S.js";import k from"./index-TCwLunZx.js";import{M as C}from"./index-BVe2A3rK.js";import{P as j}from"./Table-BPazN3dF.js";import"./request-KJyQ3YrS.js";import"./systemDept-DhqNZY_f.js";import"./dateUtil-D6r_EuKQ.js";import"./index-BtgdXNti.js";import"./common-DSNPT3jt.js";import"./index-BXxGmVdb.js";import"./index-aKKb7-FE.js";import"./index-pO-TSuVN.js";import"./Table-BBhwPCwl.js";import"./index-DyDWlBm7.js";import"./index-BcGmPhu8.js";const{confirm:g}=C,E=(e,o)=>{g({title:"确认删除吗？",icon:s.jsx(h,{}),content:"删除后不可恢复！",onOk(){f.systemMenu.menuDelete({id:e.id}).then(()=>o.current.reload())}})},R=async(e,o)=>{var r;try{await e.show(),e.remove(),(r=o.current)==null||r.reload()}catch{e.reject(new Error("something went wrong"))}},M=async(e,o,r)=>{var t;await e.show({data:o}),e.remove(),(t=r.current)==null||t.reload()},v=async(e,o,r)=>{var t;await e.show({data:o,type:"edit"}),e.remove(),(t=r.current)==null||t.reload()},I=()=>{const e=y(k),[o,r]=l.useState([]),t=l.useRef(),u=[...w,{title:"操作",valueType:"option",key:"option",align:"center",width:160,fixed:"right",render:(n,i)=>[s.jsx(a,{type:"link",onClick:()=>M(e,i,t),disabled:i.type===2,children:"新增"},"add"),s.jsx(a,{type:"link",onClick:()=>v(e,i,t),children:"编辑"},"edit"),s.jsx(a,{type:"link",onClick:()=>E(i,t),children:"删除"},"delete")]}],d=n=>{const i=[];return n.forEach(m=>{i.push(m.id);const c=m.children;c!=null&&c.length&&i.push(...d(c))}),i},p=l.useRef();return s.jsx(j,{onDataSourceChange:n=>{p.current=n},columns:u,actionRef:t,request:async n=>(n.name===""&&delete n.name,n.path===""&&delete n.path,n.component===""&&delete n.component,{data:await x(n),success:!0}),rowKey:"id",pagination:!1,expandable:{expandedRowKeys:o.length===0?void 0:o},columnEmptyText:!1,dateFormatter:"string",scroll:{x:2e3,y:800},toolBarRender:()=>[s.jsx(a,{onClick:()=>{r(d(p.current))},children:"展开全部"},"open"),s.jsx(a,{onClick:()=>{r([])},children:"折叠全部"},"close"),s.jsx(a,{type:"primary",onClick:()=>R(e,t),children:"新增"},"primary")]})};export{I as default};
