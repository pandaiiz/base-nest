import{N as v,u as h,r as p,m as P,j as e,P as C,a as k,b,c as T,S as F,B as u}from"./index-BdVTcDul.js";import{g as S,d as M}from"./common-DSNPT3jt.js";import{M as R}from"./index-BVe2A3rK.js";import{EditModal as z}from"./index-Bl3cPrgz.js";import{baseColumns as D}from"./columns-ClQvtW5R.js";import{P as E}from"./Table-BPazN3dF.js";import{P as N}from"./index-pO-TSuVN.js";import{T as o}from"./index-BtgdXNti.js";import"./request-KJyQ3YrS.js";import"./index-BXxGmVdb.js";import"./index-CJ-3cW7g.js";import"./index-aKKb7-FE.js";import"./dateUtil-D6r_EuKQ.js";import"./Table-BBhwPCwl.js";import"./index-DyDWlBm7.js";import"./index-BcGmPhu8.js";const B=v.create(()=>{const r=h(),n=p.useRef(),[s,i]=P.useMessage(),c=async()=>{var a,t;(await((t=(a=n.current)==null?void 0:a.validateFields)==null?void 0:t.call(a))).password!=="123123"&&(r.resolve(!1),s.error("密码错误！")),r.resolve(!0)};return e.jsxs(R,{title:"请输入密码",onOk:c,open:r.visible,onClose:r.remove,onCancel:r.remove,maskClosable:!1,children:[i,e.jsx(C,{formRef:n,labelCol:{span:6},wrapperCol:{span:16},submitter:!1,layout:"horizontal",children:e.jsx(k.Password,{name:"password",label:"密码"})})]})}),O=({permissionName:r,children:n})=>{const{hasPermission:s}=b(i=>({hasPermission:i.hasPermission}));return s(r)?e.jsx(e.Fragment,{children:n}):null},j=async(r,n,s)=>{var i;s?await r.show({data:s,type:"edit"}):await r.show(),r.remove(),(i=n.current)==null||i.reload()},$=()=>{const[r,n]=p.useState("全部"),[s,i]=p.useState({}),c=h(z),f=T(),a=h(B),t=p.useRef(),g=[...D,{title:"操作",valueType:"option",key:"option",align:"center",width:160,fixed:"right",render:(d,l)=>[e.jsx(u,{type:"link",onClick:async()=>{await a.show()&&(a.remove(),j(c,t,l))},children:"编辑"},"edit"),e.jsx(N,{title:"确认删除吗？",onConfirm:async()=>{var m;await a.show()&&(a.remove(),await M("io/knife-tool",l.id),(m=t==null?void 0:t.current)==null||m.reload())},children:e.jsx(u,{type:"link",danger:!0,children:"删除"})},"delete")]}],y=()=>{switch(r){case"部门":return e.jsxs(e.Fragment,{children:[e.jsxs(o,{color:"green",children:["刀具归还：",s[11]||0]}),e.jsxs(o,{color:"red",children:["刀具借出：",s[12]||0]}),e.jsxs(o,{color:"red",children:["员工报废：",s[31]||0]}),e.jsxs(o,{color:"blue",children:["余量：",(s[12]||0)-(s[11]||0)-(s[31]||0)]})]});case"厂商":return e.jsxs(e.Fragment,{children:[e.jsxs(o,{color:"green",children:["刀具入库：",s[1]||0]}),e.jsxs(o,{color:"red",children:["刀具出库：",s[2]||0]})]});case"修磨":return e.jsxs(e.Fragment,{children:[e.jsxs(o,{color:"green",children:["修磨收回：",s[21]||0]}),e.jsxs(o,{color:"red",children:["修磨发出：",s[22]||0]}),e.jsxs(o,{color:"red",children:["修磨报废：",s[32]||0]}),e.jsxs(o,{color:"blue",children:["余量：",(s[22]||0)-(s[21]||0)-(s[32]||0)]})]});case"报废":return e.jsxs(e.Fragment,{children:[e.jsxs(o,{color:"red",children:["员工报废：",s[31]||0]}),e.jsxs(o,{color:"red",children:["修磨报废：",s[32]||0]})]});default:return e.jsx(e.Fragment,{})}};return e.jsx(E,{columns:g,actionRef:t,request:async d=>{const{data:l,total:x,success:m,summary:w}=await S("io/knife-tool",{...d,tableType:r});return i(w),{data:l,success:m,total:x}},rowKey:"id",pagination:{defaultPageSize:10,showSizeChanger:!0,pageSizeOptions:["10","20","50","100"],showQuickJumper:!0},columnEmptyText:!1,dateFormatter:"string",scroll:{y:800},toolBarRender:()=>[e.jsx(y,{}),e.jsx(F,{options:["全部","部门","厂商","修磨","报废"],value:r,onChange:d=>{var l;n(d),(l=t.current)==null||l.reload()}}),e.jsx(u,{onClick:()=>f("/report/knife-tool"),children:"报表"}),e.jsx(O,{permissionName:"io:knife-tool:create",children:e.jsx(u,{type:"primary",onClick:()=>j(c,t),children:"新增"},"primary")})]})};export{$ as default};
